<div class="max-w-2xl mx-auto bg-white dark:bg-gray-900 rounded-2xl shadow-md p-6 mt-8">
  <!-- Profile Header -->
  <div class="flex items-center space-x-4">
    <% if @profile.avatar.attached? %>
      <%= image_tag @profile.avatar, class: "w-24 h-24 rounded-full object-cover border-2 border-gray-300" %>
    <% else %>
      <div class="w-24 h-24 rounded-full bg-gray-300 flex items-center justify-center text-gray-600 font-semibold">
        <%= @profile.name.first.upcase rescue "U" %>
      </div>
    <% end %>

    <div>
      <h1 class="text-2xl font-semibold text-gray-900 dark:text-white"><%= @profile.name %></h1>
      <p class="text-gray-500 dark:text-gray-400">@<%= @profile.username %></p>
      <p class="text-sm text-gray-400"><%= @profile.user.email %></p>
      <div class="flex space-x-4 mt-2 text-gray-600 dark:text-gray-300 text-sm">
        <span><strong><%= @profile.user.followees.count %></strong> Following</span>
        <span><strong><%= @profile.user.followers.count %></strong> Followers</span>
      </div>
    </div>
  </div>

  <% if current_user == @profile.user %>
    <div class="mt-4">
      <%= link_to 'Edit Profile', edit_profile_path(@profile), class: "inline-block bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg transition" %>
    </div>
  <% end %>

  <!-- Posts Section -->
  <div class="mt-10">
    <% if current_user == @profile.user %>
      <h3 class="text-xl font-semibold text-gray-800 dark:text-gray-100 mb-2">Create Post</h3>
      <div class="bg-gray-50 dark:bg-gray-800 p-4 rounded-xl shadow-sm mb-6">
        <%= render 'posts/form', post: @post %>
      </div>
    <% end %>

    <h3 class="text-xl font-semibold text-gray-800 dark:text-gray-100 mb-3"><%= @profile.name %>’s Posts</h3>

    <% if @posts.any? %>
      <ul class="space-y-4">
        <% @posts.each do |post| %>
          <li class="bg-gray-50 dark:bg-gray-800 p-4 rounded-xl shadow-sm">
            <p class="text-gray-900 dark:text-gray-100 mb-2"><%= post.content %></p>
            <% if current_user == @profile.user %>
              <%= button_to 'Delete Post', post, method: :delete, data: { turbo_confirm: "Are you sure?" }, class: "text-red-600 hover:text-red-800 text-sm" %>
            <% end %>
            <div class="mt-3 space-y-1">
              <% post.comments.each do |comment| %>
                <p class="text-sm text-gray-600 dark:text-gray-300">
                  <%= comment.comment %> 
                  <span class="text-gray-400">— <%= comment.user.profile.username %></span>
                </p>
              <% end %>
            </div>
          </li>
        <% end %>
      </ul>
    <% else %>
      <p class="text-gray-500 dark:text-gray-400">No posts yet.</p>
    <% end %>
  </div>

  <div class="mt-8 text-center">
    <%= link_to '← Back to Home', root_path, class: "text-blue-600 hover:underline" %>
  </div>
</div>
